<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Buddy System</title>
     <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <style>
        /* CSS to center the heading */
     	h1 {
            margin-bottom: 40px; /* Add margin between headings */
        }
        body {
      		display: flex;
       		font-family: 'Montserrat', sans-serif; /* Use Roboto font */
            text-align: center;
      		display: flex;
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
            background-color: #0d0d0d; /* Background color */
            color: #ffffff; /* Font color */
        }
        .background-image {
            background-image: url('https://i.pinimg.com/736x/da/ae/4f/daae4fc27943765338310774569fb05c.jpg');
            background-size: cover; /* Cover the entire element with the background image */
            width: 100%; /* Adjust width as needed */
            height: 100%; /* Adjust height as needed */
            //display: flex; /* Optional: Center content vertically */
            justify-content: center; /* Optional: Center content horizontally */
            align-items: center; /* Optional: Center content vertically */
      		box-sizing: border-box; 
      		padding: 20px; /* Add padding */
      		box-sizing: border-box; /* Include padding in element's total width/height */
            text-align: center; 
        }
      label {
    	display: block; /* Display labels as block elements */
    	margin-bottom: 5px; /* Add space between labels and input fields */
	}
    input[type="email"], input[type="password"] {
      width: 50%; /* Make input fields fill the width of their container */
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ffffff; /* Add border */
      border-radius: 150px; /* Add border radius */
      background-color: rgba(255, 255, 255, 0.1); /* Semi-transparent background */
      color: #ffffff; /* Text color */
}
   input[type="email"]:focus, input[type="password"]:focus {
      border-color: #fa4c00; /* Change border color when input is focused */
      outline: none; /* Remove default focus outline */
}
    
 button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background-color: #fa4c00;
      color: #ffffff;
      cursor: pointer;
      transition: background-color 0.3s ease; /* Smooth transition on hover */
 }
button:hover {
    background-color: #d4430cff;
}

button:focus {
    outline: none; /* Remove default focus outline */
      
}
    </style>
</head>
<body>

<div class="background-image" id="user-details">
 <h1>The Buddy System!</h1>

  
  <h2>Login</h2>

  <form id="loginForm">
      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required>
  
      <br>
  
      <label for="password">Password:</label>
      <input type="password" id="password" name="password" required>
  
      <br>
	  
 	<button onclick="window.location.href='home.html'">Login

  </form>
    <span id="invalidLogin"></span>
</div>
<script>
    document.getElementById("loginForm").addEventListener("submit", function(event) {
        event.preventDefault();

        var email = document.getElementById("email").value;
        var password = document.getElementById("password").value;

        var requestBody = {
            email: email,
            password: password
        };

        var requestOptions = {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        };
        fetch("http://localhost:8080/login", requestOptions)
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json()
            })
            .then(data => {
                if (data !== 0) {
                    fetchUserData(data);
                } else {
                    document.getElementById("invalidLogin").innerHTML = `
                    <p>Invalid login</p>
                    `;
                }
            })
    });

    // Function to fetch user data
    function fetchUserData(id) {
        // Make a GET request to the API endpoint
        fetch('http://localhost:8080/users/' + id)
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json()
            }) // Parse response as JSON
            .then(data => {
                // Display user details in the div
                document.getElementById('user-details').innerHTML = `
                    <h2>Welcome back, ${data.name}!</h2>
                `;
            })
            .catch(error => {
                console.error('Error fetching user data:', error);
                document.getElementById('user-details').innerHTML = '<p>Error fetching user data</p>';
            });
    }

    // Call fetchUserData function when the page loads
    //button. = fetchUserData;
</script>
</body>
</html>
